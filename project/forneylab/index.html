<!DOCTYPE html>
<html lang="en-US">
<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="theme" content="hugo-academic-group">

    
    

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://ljwangust.github.io/js/hugo-academic-group.js"></script>

    <link rel="stylesheet" href="https://ljwangust.github.io/css/bootstrap.min.css">
    <script src="https://ljwangust.github.io/js/bootstrap.min.js"></script>  

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/styles/default.min.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.2/gh-fork-ribbon.min.css" />
    
    
    <script src="https://ljwangust.github.io/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>


    <link rel="stylesheet" href="https://ljwangust.github.io/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://ljwangust.github.io/css/academicons.min.css">
    <link rel="stylesheet" href="https://ljwangust.github.io/css/biaslab-font.css">
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:100,300,400,700|Merriweather:100,400,700|Roboto+Mono">
    <link rel="stylesheet" href="https://ljwangust.github.io/css/hugo-academic-group.css">

    
    <link rel="stylesheet" href="https://ljwangust.github.io/css/biaslab.css">
    


    <link rel="shortcut icon" href="https://ljwangust.github.io/img/favicon.ico" type="image/x-icon">
    <link rel="canonical" href="https://ljwangust.github.io/project/forneylab/">

    <title>ForneyLab: a Julia Toolbox for Factor Graph-Based Probabilistic Programming | BIASlab</title>

</head>

<body>
<div class="home-anchor" id="home"></div>


<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
    <div class="container">

        
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <div class="navbar-brand">
                
                    <a class="logo" href="https://tue.nl">
                        <img src="https://ljwangust.github.io/img/tue-logo.png" alt="University logo"></img>
                    </a>
                
                
                 
                     
                        
                            <a href="https://www.tue.nl/en/research/research-groups/signal-processing-systems/">SPS</a>
                            /
                        
                    
                    
                        <a href="https://ljwangust.github.io/">BIASlab</a>
                    
    
                
            </div>
        </div>

        
        <div class="collapse navbar-collapse" id="#navbar-collapse-1">

            
            <ul class="nav navbar-nav navbar-right">
                
                    
                        <li class="nav-item"><a data-scroll href="https://ljwangust.github.io/#home">Home</a></li>
                    
                
                        
                        
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Research <span class="caret"></span></a>
                            <ul class="dropdown-menu">
                              
                                <li><a href="https://ljwangust.github.io/#projects">Projects</a></li>
                              
                                <li><a href="https://ljwangust.github.io/#publications">Publications</a></li>
                              
                                <li><a href="https://ljwangust.github.io/#posts">Blog</a></li>
                              
                            </ul>
                          </li>
                    
                
                        
                        
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Teaching <span class="caret"></span></a>
                            <ul class="dropdown-menu">
                              
                                <li><a href="https://ljwangust.github.io/teaching/bmlip">2022/23</a></li>
                              
                                <li><a href="https://ljwangust.github.io/teaching/archive/bmlip-2021">2021/22</a></li>
                              
                            </ul>
                          </li>
                    
                
                        
                        
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Software <span class="caret"></span></a>
                            <ul class="dropdown-menu">
                              
                                <li><a href="https://biaslab.github.io/rxinfer-website/">RxInfer.jl</a></li>
                              
                                <li><a href="https://biaslab.github.io/ForneyLab.jl/stable/">ForneyLab.jl</a></li>
                              
                                <li><a href="https://biaslab.github.io/ReactiveMP.jl/stable">ReactiveMP.jl</a></li>
                              
                                <li><a href="https://biaslab.github.io/Rocket.jl/stable">Rocket.jl</a></li>
                              
                            </ul>
                          </li>
                    
                
                    
                        <li class="nav-item"><a data-scroll href="https://ljwangust.github.io/#members">Team</a></li>
                    
                
                        
                        
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Join us <span class="caret"></span></a>
                            <ul class="dropdown-menu">
                              
                                <li><a href="https://ljwangust.github.io/research/starter-guide">Starter&#39;s guide</a></li>
                              
                                <li><a href="https://ljwangust.github.io/open-projects">Open projects</a></li>
                              
                            </ul>
                          </li>
                    
                
                    
                        <li class="nav-item"><a data-scroll href="https://ljwangust.github.io/#contact">Contact</a></li>
                    
                
                
            </ul>

        </div>
    </div>
</nav>

<div class="container">
    

    <article class="article article-project" itemscope itemtype="http://schema.org/Article">
        <h1 itemprop="name">ForneyLab: a Julia Toolbox for Factor Graph-Based Probabilistic Programming</h1>
        
        

        

        <div class="article-style" itemprop="articleBody">
            <h2 id="problem-statement">Problem Statement</h2>
<p>The goal of scientific modeling is to find increasingly better models for given datasets. While the proposal of a new model is inherently human (creative) work, the right choice of framework may allow for automated derivation of efficient algorithms for model fitting and performance evaluation. Bayesian (probabilistic) reasoning offers such a principled framework for model specification, fitting and criticism [1]. Moreover, for a large class of models, Bayesian inference can be automatically derived. The field of probabilistic programming offers tools that rely on a variety of methods (e.g. automated derivation and Monte Carlo methods) that absolve the need for manual derivations. However, their generality often comes at the cost of considerable computational load.</p>
<p>The message passing paradigm offers a convenient method for leveraging model-specific structures, while remaining generally applicable. Message passing can be conveniently formulated on a Forney-style factor graph (FFG) representation of the model [2]. Inference tasks on the model can then be decomposed in local computations, represented by messages that flow across the graph. This locality allows for storing pre-computed message updates in a look-up table that can be re-used across models. Automated algorithm construction then amounts to scheduling these messages in the order required by the inference task (see also <a href="https://ljwangust.github.io/publication/forneylab-julia-toolbox/">this conference paper at JuliaCon</a>).</p>
<p>ForneyLab (<a href="https://github.com/biaslab/ForneyLab.jl">GitHub</a>) is introduced in <a href="https://www.sciencedirect.com/science/article/pii/S0888613X18304298">this paper</a> [5] as a novel Julia package that allows the user to specify a probabilistic model as an FFG and pose inference problems on this FFG. In return, ForneyLab automatically constructs a Julia program that executes a message passing-based (approximate) inference procedure. ForneyLab is designed with a focus on flexibility, extensibility and applicability to biologically plausible models for perception and decision making, such as the hierarchical Gaussian filter (HGF) [3]. With ForneyLab, the search for better models for perception and action can be accelerated (see also <a href="https://ljwangust.github.io/publication/forneylab-biologically-plausible-fem/">this conference paper at CCS</a>).</p>
<h2 id="methods-and-solution-proposal">Methods and Solution Proposal</h2>
<p>An FFG offers a computational network representation of a probabilistic model, where edges represent variables and nodes capture probabilistic relationships between variables [4]. The figure below shows the FFG for the HGF and a message passing schedule for on-line state inference.</p>
<img src="https://ljwangust.github.io/img/projects/ForneyLab/hgf.png" width="500px">
<p>With ForneyLab, the automated derivation of this message passing algorithm may be completed in three phases. (1) The <em>build</em> phase specifies the model by a domain-specific syntax that (under the hood) constructs the model FFG. (2) The <em>schedule</em> phase specifies the inference problem. ForneyLab automatically constructs a message passing algorithm that computes the posterior marginal beliefs over the quantities of interest. (3) The <em>infer</em> phase parses and executes the automatically generated algorithm code and optional model performance metric. See the video below from JuliaCon for a quick introduction to ForneyLab.</p>
<div class="video-wrapper">
    <div class="embed video-player">
        <iframe class="youtube-player" type="text/html" src="https://www.youtube.com/embed/RS4hJ4oBr9c" allowfullscreen frameborder="0">
        </iframe>
    </div>
</div>
<h2 id="results">Results</h2>
<p>ForneyLab is especially potent when applied to time-series data. In this section we place ForneyLab within the time-performance landscape by comparing with Edward and Stan, two popular probabilistic programming toolboxes that employ automated differentiation and sampling-based inference. As an example application, we fit a random walk model to artificial observations and compare predictive performance on a hold-out set (see also <a href="https://ljwangust.github.io/publication/forneylab-fast-and-flexible">this conference paper at ProbProg</a>). The results are shown in the figure below, where it can be seen ForneyLab attains comparable performance in significantly less computation time [5].</p>
<img src="https://ljwangust.github.io/img/projects/ForneyLab/random_walk.png" width="500px">
<h3 id="references">References</h3>
<p>[1] Blei, David M. &ldquo;Build, compute, critique, repeat: Data analysis with latent variable models.&rdquo; <em>Annual Review of Statistics and Its Application 1</em> (2014): 203-232.</p>
<p>[2] Forney, G. David. &ldquo;Codes on graphs: Normal realizations.&rdquo; <em>IEEE Transactions on Information Theory 47.2</em> (2001): 520-548.</p>
<p>[3] Mathys, Christoph D., et al. &ldquo;Uncertainty in perception and the Hierarchical Gaussian Filter.&rdquo; <em>Frontiers in human neuroscience 8</em> (2014): 825.</p>
<p>[4] Loeliger, H-A. &ldquo;An introduction to factor graphs.&rdquo; <em>IEEE Signal Processing Magazine 21.1</em> (2004): 28-41.</p>
<p>[5] Cox, M., van de Laar, T., de Vries, B. &ldquo;A Factor Graph Approach to Automated Design of Bayesian Signal Processing Algorithms&rdquo;, International Journal of Approximate Reasoning (2019), 10.1016/j.ijar.2018.11.002.</p>

        </div>
    
        
        <h3>Participants</h3>
        <div id="participants"> 
            <div class="container">
                <div class="row">
                    
                

                
                    

                    
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                            <div class="col-xs-12 col-md-2">
                                <div id="profile">
                                    <a href="https://ljwangust.github.io/member/thijs/">
                                        <div class="small-portrait" itemprop="image" style="background-image: url('https://ljwangust.github.io/img/portraits/Thijs.png');"></div>
                                    </a>
                                    <div class="portrait-title">
                                        <h3 itemprop="name"><a href="https://ljwangust.github.io/member/thijs/">Thijs van de Laar</a></h3>
                                        <h4></h4>
                                    </div>
                                </div>
                            </div>
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     


                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     

                     
                
                    

                    
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     


                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                            <div class="col-xs-12 col-md-2">
                                <div id="profile">
                                    <a href="
                                                https://www.linkedin.com/in/marco-cox-a455a01b/
                                              ">
                                        <div class="small-portrait" itemprop="image" style="background-image: url('https://ljwangust.github.io/img/portraits/Marco.jpg');"></div>
                                    </a>
                                    <div class="portrait-title">
                                        <h3 itemprop="name">
                                            <a href="
                                                    https://www.linkedin.com/in/marco-cox-a455a01b/
                                                "
                                            >Marco Cox</a>
                                        </h3>
                                        <h4></h4>
                                    </div>
                                </div>
                            </div>
                         
                     
                         
                     
                         
                     

                     
                
                    

                    
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     


                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                            <div class="col-xs-12 col-md-2">
                                <div id="profile">
                                    <a href="
                                                https://www.linkedin.com/in/ivan-bocharov-4a789a98/
                                              ">
                                        <div class="small-portrait" itemprop="image" style="background-image: url('https://ljwangust.github.io/img/portraits/Ivan.png');"></div>
                                    </a>
                                    <div class="portrait-title">
                                        <h3 itemprop="name">
                                            <a href="
                                                    https://www.linkedin.com/in/ivan-bocharov-4a789a98/
                                                "
                                            >Ivan Bocharov</a>
                                        </h3>
                                        <h4></h4>
                                    </div>
                                </div>
                            </div>
                         
                     
                         
                     

                     
                
                    

                    
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                            <div class="col-xs-12 col-md-2">
                                <div id="profile">
                                    <a href="https://ljwangust.github.io/member/bert/">
                                        <div class="small-portrait" itemprop="image" style="background-image: url('https://ljwangust.github.io/img/portraits/Bert.jpg');"></div>
                                    </a>
                                    <div class="portrait-title">
                                        <h3 itemprop="name"><a href="https://ljwangust.github.io/member/bert/">Bert de Vries</a></h3>
                                        <h4></h4>
                                    </div>
                                </div>
                            </div>
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     


                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     
                         
                     

                     
                


               
                </div>
            </div>
        </div>
        
     </article>
    
   <nav>
    <ul class="pager">
        
        <li class="previous">
            <a href="https://ljwangust.github.io/project/a-probabilistic-approach-to-in-situ-trainable-gesture-recognition/">
                <span aria-hidden="true" class="darknav">&larr;&nbsp;Previous project:</span>
                A Probabilistic Modeling Approach to In-situ Trainable Gesture Recognition
            </a>
        </li>
        

        
        <li class="next">
            <a href="https://ljwangust.github.io/project/learning-where-to-park-by-active-inference/">
                <span class="darknav">&nbsp;Next project:</span>
                Learning Where to Park by Active Inference
                <span aria-hidden="true" class="darknav">&rarr;</span>
            </a>
        </li>
        
    </ul>
</nav>


</div>

<footer class="site-footer">
    <div class="container">
        <p class="powered-by">

            © BIASlab, 2022 &middot; 

            Partially powered by the <a href="https://github.com/gcushen/hugo-academic" target="_blank">Academic theme</a> for <a href="http://gohugo.io" target="_blank">Hugo</a>.

            <span class="pull-right"><a href="#home" id="back_to_top"><span class="button_icon"><i class="fa fa-chevron-up fa-2x" aria-hidden="true"></i></span></a></span>

        </p>
    </div>
</footer>

<script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>




<script type="text/x-mathjax-config">
 MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
</script>

<script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML">
</script>

</body>
</html>

